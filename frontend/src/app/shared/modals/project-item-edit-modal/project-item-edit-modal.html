<section>
  <div class="header">
    <h2>Task details</h2>
  </div>

  <mat-dialog-content class="content">
    <div>
      <span>Task title</span>
      <mat-form-field class="form-group" appearance="outline">
        <input
          type="text"
          matInput
          name="name"
          required
          [(ngModel)]="title"
          placeholder="Task title..."
          #nameRef="ngModel"
          (keydown.space)="$event.preventDefault()"
        />
      </mat-form-field>
      @if (nameRef.invalid && nameRef.touched) {
      <mat-error> Title required </mat-error>
      }
    </div>
    <div>
      <span>Description</span>
      <mat-form-field class="form-group" appearance="outline">
        <textarea
          matInput
          name="description"
          [(ngModel)]="description"
          placeholder="Description"
        ></textarea>
      </mat-form-field>
    </div>
    <div>
      <span>Add assignees - Optional</span>
      <mat-form-field class="form-group" appearance="outline">
        <input
          type="text"
          placeholder="Add assignees"
          matInput
          [formControl]="myControl"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          #auto="matAutocomplete"
          (optionSelected)="addTaskMember($event.option.value)"
        >
          @for (option of (options | async); track option.value ) {
          <mat-option [value]="option">{{ option.label }}</mat-option>
          }
        </mat-autocomplete>
      </mat-form-field>

      <div class="selected-chip">
        @for (user of selectedUsers; track $index) {
        <mat-chip (removed)="this.selectedUsers.splice($index, 1)"
          >{{ user.label }}
          <mat-icon matChipRemove>X</mat-icon>
        </mat-chip>
        }
      </div>
    </div>

    @if (taskExist) {
    <div>
      <button mat-button (click)="deleteTask()"><mat-icon>delete_outline</mat-icon></button>
    </div>
    }
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button matButton mat-dialog-close>Cancel</button>
    <button matButton (click)="submit()" cdkFocusInitial [disabled]="nameRef.invalid">
      Submit
    </button>
  </mat-dialog-actions>
</section>
